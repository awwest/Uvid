(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{33:function(e,t,a){e.exports=a(73)},39:function(e,t,a){},40:function(e,t,a){},73:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(27),s=a.n(o),i=a(77),l=(a(39),a(5)),c=a(6),u=a(8),m=a(7),d=a(13),p=a(9),h=a(78),g=a(75),f=a(76),v=a(79),b=(a(40),a(28));var E=function(e){return r.a.createElement("div",{className:"mt-5 card border-primary mr-5 ml-5"},r.a.createElement("div",{className:"card-header"},e.name," posted at ",new Date(e.time).toLocaleString()),r.a.createElement("div",{className:"card-body bg-primary"},r.a.createElement(b.a,{videoId:e.videoId,id:e.videoId,onError:e.onError,className:"player"})))},y=a(18),w=a.n(y),N={post:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.authenticity_token=document.querySelector('meta[name="csrf-token"]').content,w.a.post(e,t)},get:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.authenticity_token=document.querySelector('meta[name="csrf-token"]').content,w.a.get(e,t)},delete:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.authenticity_token=document.querySelector('meta[name="csrf-token"]').content,w.a.delete(e,{params:t})}};var S=function(e){return r.a.createElement("ul",{className:"pagination pagination-lg mt-5 justify-content-center"},e.shouldShowPrev&&r.a.createElement("li",{className:"page-item"},r.a.createElement("button",{type:"button",className:"page-link",onClick:e.prevPage,name:"prev"},"\xab")),r.a.createElement("li",{className:"page-item active"},r.a.createElement("button",{type:"button",className:"page-link",href:"#"},e.page)),e.shouldShowNext&&r.a.createElement("li",{className:"page-item"},r.a.createElement("button",{type:"button",className:"page-link",href:"#",onClick:e.nextPage,name:"next"},"\xbb")))};var L=function(){return r.a.createElement("div",{className:"spinner mt-5",style:{height:"30px",width:"30px",position:"relative",left:"49%",border:"8px solid #fff",borderColor:"rgb(0, 0, 0) transparent rgb(0, 7, 255) rgb(55, 55, 255)",borderRightColor:"transparent",borderRadius:"50%",boxShadow:"0 0 25px 2px #eee",WebkitAnimation:"spin 1s linear infinite",MozAnimation:"spin 1s linear infinite",MsAnimation:"spin 1s linear infinite",OAnimation:"spin 1s linear infinite",animation:"spin 1s linear infinite"}})},k=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={page:1,videos:[],isLoading:!0},a.prevPage=function(){a.setState({page:a.state.page-1},a.fetchData)},a.nextPage=function(){a.setState({page:a.state.page+1},a.fetchData)},a.fetchData=function(){N.get("/api/feed?page=".concat(a.state.page)).then(function(e){var t=e.data.videos.map(function(t){return t.user=e.data.users.find(function(e){return e.video===t.id}),t});a.setState({videos:t,isLoading:!1})})},a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){return r.a.createElement("div",null,this.state.isLoading?r.a.createElement(L,null):this.state.videos.length?this.state.videos.map(function(e){return r.a.createElement(E,{videoId:e.video_id,key:e.id,name:e.user.name,time:e.created_at})}):r.a.createElement("div",{className:"alert alert-info"},"Looks like you haven't followed anyone yet. Click on the Users tab!"),r.a.createElement(S,{prevPage:this.prevPage,nextPage:this.nextPage,page:this.state.page,shouldShowNext:30===this.state.videos.length,shouldShowPrev:this.state.page>1}))}}]),t}(r.a.Component),O=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={video:""},a.handleChange=function(e){var t=e.target.value.split("v=")[1]&&e.target.value.split("v=")[1].split("&")[0];a.setState({video:t,error:null}),t&&11===t.length||a.playerError()},a.handleSubmit=function(e){e.preventDefault(),a.state.error||N.post("/posts",{video:a.state.video},{withCredentials:!0}).then(function(e){a.props.history.push("/")}).catch(function(){a.setState({error:"Server error, please try again"})})},a.playerError=function(){a.setState({error:"Error, check the URL"})},a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"jumbotron"},r.a.createElement("form",{onSubmit:this.handleSubmit},this.state.error?r.a.createElement("div",{className:"alert alert-danger"},this.state.error):r.a.createElement(r.a.Fragment,null),r.a.createElement("input",{className:"form-control",type:"url",placeholder:"Paste YouTube video URL",onChange:this.handleChange}),r.a.createElement("button",{className:"mt-4 btn btn-primary",type:"submit"},"Post")),this.state.video?r.a.createElement(E,{time:new Date,videoId:this.state.video,onError:this.playerError}):r.a.createElement("br",null))}}]),t}(r.a.Component),j=Object(v.a)(O),I=a(74);var C=function(e){return r.a.createElement(r.a.Fragment,null,e.users.map(function(t){return r.a.createElement(I.a,{className:"card text-white bg-primary mb-3 mt-3",key:t.id,to:{pathname:"/profile/"+t.id,state:{isLoggedIn:e.isLoggedIn,id:t.id}}},r.a.createElement("h2",{className:"card-header card-title"},t.name),r.a.createElement("div",{className:"card-body"},r.a.createElement("span",{className:"badge badge-pill badge-primary mr-4 mb-2"},t.posts.length," videos shared"),r.a.createElement("span",{className:"badge badge-pill badge-secondary"},"".concat(t.followers.length," followers")),r.a.createElement("span",{className:"ml-3 badge badge-pill badge-secondary"},"Following ".concat(t.following.length))))}))},x=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={users:[],page:1,isLoading:!0},a.fetchData=function(){N.get("/users",{page:a.state.page}).then(function(e){a.setState({users:e.data.users,isLoading:!1})})},a.nextPage=function(){a.setState({page:a.state.page+1}),a.fetchData()},a.prevPage=function(){a.setState({page:a.state.page-1}),a.fetchData()},a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){return r.a.createElement("div",null,this.state.isLoading?r.a.createElement(L,null):r.a.createElement(C,{users:this.state.users,isLoggedIn:this.props.location.state.isLoggedIn}),r.a.createElement(S,{page:this.state.page,nextPage:this.nextPage,prevPage:this.prevPage,shouldShowNext:30===this.state.users.length,shouldShowPrev:this.state.page>1}))}}]),t}(r.a.Component),P=a(32),D=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={isLoading:!0,page:1,id:a.props.match&&a.props.match.params.id||a.props.location.state.id,following:[],followers:[],name:"",isCurrentUser:!0,posts:[],isLoggedIn:a.props.location.state.isLoggedIn},a.fetchData=function(){N.get("/users/".concat(a.state.id),{page:a.state.page}).then(function(e){var t=e.data;a.setState(Object(P.a)({isLoading:!1},t))})},a.nextPage=function(){a.setState({page:a.state.page+1,isLoading:!0}),a.fetchData()},a.prevPage=function(){a.setState({page:a.state.page-1,isLoading:!0}),a.fetchData()},a.follow=function(){N.post("/relationships",{followed_id:a.state.id}).then(function(){a.setState({isFollowedByCurrentUser:!0})})},a.unfollow=function(){N.delete("/relationships/"+a.state.id).then(function(){a.setState({isFollowedByCurrentUser:!1})})},a.deleteVideo=function(e){window.confirm("Are you sure you want to delete this video?")&&N.delete("/posts/".concat(e)).then(function(){a.setState({posts:a.state.posts.filter(function(t){return t.id!==e})})})},a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"componentDidUpdate",value:function(e,t){this.state.id!==t.id&&(this.setState({isLoading:!0}),this.fetchData())}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,!this.state.isCurrentUser&&this.state.isLoggedIn&&(this.state.isFollowedByCurrentUser?r.a.createElement("button",{className:"btn btn-outline-secondary mt-5",type:"button",onClick:this.unfollow},"UNFOLLOW"):r.a.createElement("button",{className:"btn btn-outline-primary mt-5",type:"button",onClick:this.follow},"FOLLOW")),this.state.isLoading?r.a.createElement(L,null):this.state.posts.map(function(t){return r.a.createElement("div",{key:t.id},r.a.createElement(E,{videoId:t.video_id,time:t.created_at,name:e.state.name,key:t.id}),e.state.isCurrentUser&&r.a.createElement("button",{className:"btn btn-danger",onClick:function(){return e.deleteVideo(t.id)}},"X"))}),r.a.createElement(S,{page:this.state.page,nextPage:this.nextPage,prevPage:this.prevPage,shouldShowNext:30===this.state.posts.length,shouldShowPrev:this.state.page>1}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.location.state.id!==t.id?{id:e.location.state.id}:null}}]),t}(r.a.Component),A=a(12),F=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={username:"",password:""},a.handleInput=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(A.a)({},n,r))},a.handleSubmit=function(e){e.preventDefault(),a.props.handleLogin(a.state.name,a.state.password)},a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"jumbotron col mt-4 mb-3 mr-3"},r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("p",{className:"lead"},"Log in"),this.props.error?r.a.createElement("div",{className:"alert alert-danger"},this.props.error):r.a.createElement(r.a.Fragment,null),r.a.createElement("input",{name:"name",className:"form-control mb-3",type:"text",placeholder:"Enter username",onChange:this.handleInput}),r.a.createElement("input",{name:"password",className:"form-control mb-3",type:"password",placeholder:"Enter password",onChange:this.handleInput}),r.a.createElement("button",{className:"btn btn-primary",type:"submit"},"Log in")))}}]),t}(r.a.Component),U=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={username:"",password:""},a.handleInput=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(A.a)({},n,r))},a.handleSubmit=function(e){e.preventDefault(),a.props.handleSignup(a.state.username,a.state.password,a.state.password_confirmation)},a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"jumbotron mt-4 mb-3 col"},r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("p",{className:"lead"},"Sign Up"),this.props.error?r.a.createElement("div",{className:"alert alert-danger"},this.props.error):r.a.createElement(r.a.Fragment,null),r.a.createElement("input",{name:"username",required:!0,className:"form-control mb-3",type:"text",placeholder:"Choose a username",onChange:this.handleInput}),r.a.createElement("input",{name:"password",required:!0,className:"form-control mb-3",type:"password",placeholder:"Enter a password",onChange:this.handleInput}),r.a.createElement("input",{name:"password_confirmation",required:!0,className:"form-control mb-3",type:"password",placeholder:"Confirm your password",onChange:this.handleInput}),r.a.createElement("button",{className:"btn btn-primary",type:"submit"},"Create")))}}]),t}(r.a.Component);var _=function(e){return r.a.createElement("header",null,r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-dark bg-primary"},r.a.createElement("ul",{className:"navbar-nav mr-auto"},e.isLoggedIn&&r.a.createElement(r.a.Fragment,null,r.a.createElement("li",{className:"nav-item"},r.a.createElement(I.a,{className:"nav-link",to:"/"},"Feed")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(I.a,{className:"nav-link",to:{pathname:"/users",state:{isLoggedIn:e.isLoggedIn}}},"Users")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(I.a,{className:"nav-link",to:"/upload"},"New Post")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(I.a,{className:"nav-link",to:{pathname:"/profile/"+e.userId,state:{isLoggedIn:e.isLoggedIn,id:e.userId}}},"Profile")))),e.isLoggedIn?r.a.createElement("button",{className:"btn btn-outline-secondary",onClick:e.logout,type:"button"},"Logout"):r.a.createElement(I.a,{className:"btn btn-secondary",to:"/"},"Login")))},q=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={isLoggedIn:!1,userId:"",loginError:"",signupError:""},a.handleLogin=a.handleLogin.bind(Object(d.a)(a)),a.handleSignup=a.handleSignup.bind(Object(d.a)(a)),a.logout=a.logout.bind(Object(d.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"handleSignup",value:function(e,t,a){var n=this,r={name:e,password:t,password_confirmation:a};N.post("/users",r).then(function(e){n.setState({isLoggedIn:!0,userId:e.data.id})}).catch(function(e){n.setState({signupError:"Hmm, that's not working. Try again?"})})}},{key:"handleLogin",value:function(e,t){var a=this;N.post("/login",{password:t,name:e}).then(function(e){a.setState({isLoggedIn:!0,userId:e.data.id})}).catch(function(e){a.setState({loginError:"Try Again"})})}},{key:"logout",value:function(){var e=this;N.delete("/logout").then(function(){e.setState({isLoggedIn:!1}),e.props.history.push("/")})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App"},r.a.createElement(i.a,null,r.a.createElement("div",null,r.a.createElement(_,{isLoggedIn:this.state.isLoggedIn,userId:this.state.userId,logout:this.logout}),r.a.createElement(h.a,null,r.a.createElement(g.a,{exact:!0,path:"/",render:function(){return e.state.isLoggedIn?r.a.createElement(k,null):r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement(F,{handleLogin:e.handleLogin,error:e.state.loginError}),r.a.createElement(U,{handleSignup:e.handleSignup,error:e.state.signupError})))}}),r.a.createElement(g.a,{exact:!0,path:"/upload",render:function(){return e.state.isLoggedIn?r.a.createElement(j,null):r.a.createElement(f.a,{to:"/"})}}),r.a.createElement(g.a,{path:"/profile/:id",component:D}),r.a.createElement(g.a,{exact:!0,path:"/users",component:x})))))}}]),t}(n.Component),B=Object(v.a)(q);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(i.a,null,r.a.createElement(B,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[33,1,2]]]);
//# sourceMappingURL=main.a8ae1680.chunk.js.map